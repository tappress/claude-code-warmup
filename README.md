# ⚡ Claude Code Warmup

> Automatically warm up your Claude Code rate limit window so it resets right before your work session.

---

## The Problem

Claude Code's rate limits work on a **rolling 5-hour window** — the clock starts from your **first request**, not midnight. So if you sleep in and start at noon, you get a short window for the day.

**Solution:** Send a tiny warm-up message a few hours before you plan to work. The 5-hour window starts then, resets before you begin, and you get full quota.

---

## How It Works

1. A **Vercel cron job** fires at your configured time (e.g. 06:00 UTC)
2. It uses your `CLAUDE_CODE_OAUTH_TOKEN` to authenticate with the Anthropic API
3. Sends a short message to Claude via the Anthropic API
4. Your 5-hour window starts ticking → resets before your workday begins ✅

---

## One-Click Deploy

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/tappress/claude-code-warmup)

---

## Setup (Manual)

### 1. Fork & Clone

```bash
git clone https://github.com/tappress/claude-code-warmup
cd claude-code-warmup
```

### 2. Set the Cron Schedule

Edit `vercel.json` and change the `schedule` to fire 3–4 hours before your usual start time (**UTC**). Example config to run it at 6 AM UTC `"schedule": "0 6 * * *"`:

```json
{
  "crons": [
    {
      "path": "/api/warmup",
      "schedule": "0 6 * * *"
    }
  ]
}
```

> **Tip:** Use [crontab.guru](https://crontab.guru) to build your expression.
> Vercel free tier supports daily crons. Pro tier supports up to hourly.

### 3. Generate a Long-Lived OAuth Token

Claude Code has a built-in command to generate a dedicated long-lived token with minimal `user:inference` scope (no privileged account access):

```bash
claude setup-token
```

This prints a token that looks like `sk-ant-oat01-...` and is **valid for 1 year**. Copy it — you won't see it again.

> No need to touch `~/.claude/.credentials.json` or store tokens in Redis.

### 4. Deploy to Vercel

1. Go to [vercel.com/new](https://vercel.com/new) → Import your forked repo
2. In **Environment Variables**, add:

| Variable | Value |
|---|---|
| `CLAUDE_CODE_OAUTH_TOKEN` | `sk-ant-oat01-...` (from `claude setup-token`) |
| `WARMUP_MESSAGE` | *(optional)* Custom message |

3. Deploy!

## Environment Variables

| Variable | Required | Default | Description |
|---|---|---|---|
| `CLAUDE_CODE_OAUTH_TOKEN` | ✅ | — | Long-lived OAuth token from `claude setup-token` (valid 1 year) |
| `WARMUP_MESSAGE` | ❌ | *"Hello! This is an automated warm-up..."* | Custom message sent to Claude |
| `CRON_SECRET` | ✅ | *auto (Vercel)* | Auto-generated by Vercel — locks endpoint to cron only |

---

## Local Development

```bash
npm install
cp .env.example .env.local
# Fill in CLAUDE_CODE_OAUTH_TOKEN in .env.local

npx vercel dev
# Then open http://localhost:3000 or curl http://localhost:3000/api/warmup
```

---

## How the Auth Works

`claude setup-token` generates a long-lived OAuth token (`sk-ant-oat01-...`) with the minimal `user:inference` scope needed to send messages. It is sent directly as a Bearer token to the Anthropic API — no token rotation, no Redis, no extra infrastructure needed.

---

## License

MIT
